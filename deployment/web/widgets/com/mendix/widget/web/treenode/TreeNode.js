define(["exports","react/jsx-runtime","react","mendix/components/web/Icon"],function(e,n,t,r){"use strict";function o(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var a,i={exports:{}};
/*!
  	Copyright (c) 2018 Jed Watson.
  	Licensed under the MIT License (MIT), see
  	http://jedwatson.github.io/classnames
  */var d,c=(a||(a=1,d=i,function(){var e={}.hasOwnProperty;function n(){for(var e="",n=0;n<arguments.length;n++){var o=arguments[n];o&&(e=r(e,t(o)))}return e}function t(t){if("string"==typeof t||"number"==typeof t)return t;if("object"!=typeof t)return"";if(Array.isArray(t))return n.apply(null,t);if(t.toString!==Object.prototype.toString&&!t.toString.toString().includes("[native code]"))return t.toString();var o="";for(var a in t)e.call(t,a)&&t[a]&&(o=r(o,a));return o}function r(e,n){return n?e?e+" "+n:e+n:e}d.exports?(n.default=n,d.exports=n):window.classNames=n}()),i.exports),l=o(c);const s={Enter:"Enter"," ":"Space",Home:"Home",End:"End",ArrowUp:"ArrowUp",ArrowDown:"ArrowDown",ArrowLeft:"ArrowLeft",ArrowRight:"ArrowRight"};const u=e=>t.useCallback(n=>{var t;if(function(e){return e.currentTarget===e.target}(n)&&(t=n.key,Object.hasOwn(s,t))){const t=e[s[n.key]];if(!t)return;n.stopPropagation(),n.preventDefault(),t(n)}},[e]);const h=e=>{let{className:t}=e;return n.jsx("svg",{className:t,"aria-hidden":!0,width:"16",height:"16",viewBox:"0 0 16 16",xmlns:"http://www.w3.org/2000/svg",children:n.jsx("path",{d:"M1.64598 4.64601C1.69242 4.59945 1.7476 4.5625 1.80834 4.5373C1.86909 4.51209 1.93421 4.49911 1.99998 4.49911C2.06575 4.49911 2.13087 4.51209 2.19161 4.5373C2.25236 4.5625 2.30753 4.59945 2.35398 4.64601L7.99998 10.293L13.646 4.64601C13.6925 4.59952 13.7477 4.56264 13.8084 4.53749C13.8691 4.51233 13.9342 4.49938 14 4.49938C14.0657 4.49938 14.1308 4.51233 14.1916 4.53749C14.2523 4.56264 14.3075 4.59952 14.354 4.64601C14.4005 4.6925 14.4373 4.74769 14.4625 4.80842C14.4877 4.86916 14.5006 4.93426 14.5006 5.00001C14.5006 5.06575 14.4877 5.13085 14.4625 5.19159C14.4373 5.25233 14.4005 5.30752 14.354 5.35401L8.35398 11.354C8.30753 11.4006 8.25236 11.4375 8.19161 11.4627C8.13087 11.4879 8.06575 11.5009 7.99998 11.5009C7.93421 11.5009 7.86909 11.4879 7.80834 11.4627C7.7476 11.4375 7.69242 11.4006 7.64598 11.354L1.64598 5.35401C1.59942 5.30756 1.56247 5.25239 1.53727 5.19164C1.51206 5.1309 1.49908 5.06578 1.49908 5.00001C1.49908 4.93424 1.51206 4.86912 1.53727 4.80837C1.56247 4.74763 1.59942 4.69245 1.64598 4.64601V4.64601Z"})})},f=e=>{let{icon:t}=e,o=t;return t&&"image"!==t.type&&(o={...t,iconClass:l(t.iconClass,"widget-tree-node-branch-header-icon")}),n.jsx(r.Icon,{icon:o})};const C=t.createContext({level:0,informParentOfChildNodes:()=>null}),m="widget-tree-node-body",g=e=>"".concat(e,"TreeNodeBranchHeader"),v=e=>"".concat(e,"TreeNodeBranchBody");function p(e){let{animateTreeNodeContent:r,changeFocus:o,children:a,headerContent:i,iconPlacement:d,id:c,isUserDefinedLeafNode:s,openNodeOn:h,renderHeaderIcon:f,startExpanded:p}=e;const{level:N}=t.useContext(C),E=t.useRef(null),I=t.useRef(null),[w,A]=t.useState(s||!a),[b,x]=t.useState(p?"EXPANDED":"COLLAPSED_WITH_JS"),{isAnimating:S,captureElementHeight:L,animateTreeNodeContent:T,cleanupAnimation:D}=(e=>{const n=t.useRef(void 0),[r,o]=t.useState(!1);return{isAnimating:r,captureElementHeight:t.useCallback(()=>{var t,r;n.current=null!==(t=null===(r=e.current)||void 0===r?void 0:r.getBoundingClientRect().height)&&void 0!==t?t:0},[]),animateTreeNodeContent:t.useCallback(()=>{if(e.current&&void 0!==n.current&&!Number.isNaN(n.current)){const t=e.current.getBoundingClientRect().height;if(t-n.current!==0){o(!0),e.current.style.height="".concat(n.current,"px");const r=setTimeout(()=>{e.current.style.height="".concat(t,"px"),n.current=t},1);return()=>clearTimeout(r)}}},[]),cleanupAnimation:t.useCallback(()=>{var n;o(!1),null===(n=e.current)||void 0===n||n.style.removeProperty("height")},[])}})(I),O=t.useCallback(e=>{var n,t,r;const o=e.target;return!(null!==(n=E.current)&&void 0!==n&&n.isSameNode(o)||null!==(t=E.current)&&void 0!==t&&null!==(t=t.firstElementChild)&&void 0!==t&&t.contains(o)||null!==(r=E.current)&&void 0!==r&&null!==(r=r.lastElementChild)&&void 0!==r&&r.isSameNode(o))},[]),y=t.useCallback(e=>{O(e)||w||(L(),x(e=>"LOADING"===e?e:"COLLAPSED_WITH_JS"===e?"LOADING":"COLLAPSED_WITH_CSS"===e?"EXPANDED":"COLLAPSED_WITH_CSS"))},[L,O,w]),P=((e,n,r,o,a)=>{const i=t.useMemo(()=>({Enter:e,Space:e,Home:e=>n(e.currentTarget,"FIRST"),End:e=>n(e.currentTarget,"LAST"),ArrowUp:e=>n(e.currentTarget,"PREVIOUS","HORIZONTAL"),ArrowDown:e=>n(e.currentTarget,"NEXT","HORIZONTAL"),ArrowRight:t=>{"COLLAPSED_WITH_CSS"===r||"COLLAPSED_WITH_JS"===r?e(t):("EXPANDED"===r||o)&&n(t.currentTarget,"NEXT","VERTICAL")},ArrowLeft:t=>{"COLLAPSED_WITH_CSS"===r||"COLLAPSED_WITH_JS"===r||o?n(t.currentTarget,"PREVIOUS","VERTICAL"):"EXPANDED"===r&&e(t)}}),[e,n,r,o]),d=u(i);return t.useCallback(e=>{if(!a(e))return d(e)},[a,d])})(y,o,b,w,O),k={"aria-expanded":"EXPANDED"===b,role:"treeitem",tabIndex:0};const _="iconClick"===h,j="headerClick"===h,H=_?y:void 0,R=j?y:void 0,{hasNestedTreeNode:X}=(e=>({hasNestedTreeNode:t.useCallback(()=>{var n,t;return null===(n=null===(t=e.current)||void 0===t||null===(t=t.lastElementChild)||void 0===t?void 0:t.className.includes("widget-tree-node"))||void 0===n||n},[])}))(I);return t.useLayoutEffect(()=>{if(r&&"LOADING"!==b){const e=T();if(e)return e}},[T,r,b]),t.useEffect(()=>{A(s||!a)},[a,s]),t.useEffect(()=>{"LOADING"===b&&(X()||x("EXPANDED"))},[X,b]),n.jsxs("li",{className:"widget-tree-node-branch",onKeyDown:P,ref:E,...k,children:[n.jsxs("span",{className:l("widget-tree-node-branch-header",{"widget-tree-node-branch-header-clickable":!w&&j,"widget-tree-node-branch-header-reversed":"left"===d}),id:g(c),onClick:R,children:[n.jsx("span",{className:"widget-tree-node-branch-header-value",children:i}),!w&&"no"!==d&&n.jsx("span",{className:l("widget-tree-node-branch-header-icon-container",{"widget-tree-node-branch-header-clickable":!w&&_}),onClick:H,children:f(b,d)})]}),(!w&&"COLLAPSED_WITH_JS"!==b||S)&&n.jsx(C.Provider,{value:{level:N+1,informParentOfChildNodes:e=>{void 0!==e&&(x(e=>"LOADING"===e?"EXPANDED":e),A(n=>0===e&&!n||!(e>0&&n)&&n))}},children:n.jsx("div",{className:l(m,{"widget-tree-node-branch-hidden":"COLLAPSED_WITH_CSS"===b&&!S,"widget-tree-node-branch-loading":"LOADING"===b}),id:v(c),"aria-hidden":"EXPANDED"!==b,ref:I,onTransitionEnd:D,children:a})})]})}function N(e){var r;let{class:o,items:a,style:i,isUserDefinedLeafNode:d,showCustomIcon:c,startExpanded:s,iconPlacement:u,expandedIcon:g,collapsedIcon:v,tabIndex:N,animateIcon:E,animateTreeNodeContent:I,openNodeOn:w}=e;const{level:A}=t.useContext(C),[b,x]=function(){const[e,n]=t.useState(null);return[e,t.useCallback(e=>{e&&n(e)},[])]}(),S=t.useCallback((e,t)=>function(e,t,r){if("LOADING"===e)return n.jsx("img",{src:"widgets/com/mendix/widget/web/treenode/assets/72df3b1b0b37a958.svg",className:"widget-tree-node-loading-spinner",alt:"","aria-hidden":!0});const{animateIcon:o,collapsedIcon:a,expandedIcon:i,showCustomIcon:d}=r,c="EXPANDED"===e;return d?n.jsx(f,{icon:c?i:a}):n.jsx(h,{className:l("widget-tree-node-branch-header-icon",{"widget-tree-node-branch-header-icon-animated":o,"widget-tree-node-branch-header-icon-collapsed-left":!c&&"left"===t,"widget-tree-node-branch-header-icon-collapsed-right":!c&&"right"===t})})}(e,t,{animateIcon:E,collapsedIcon:v,expandedIcon:g,showCustomIcon:c}),[v,g,c,E]),L=t.useCallback(()=>{var e,n;return null!==(e=null==b||null===(n=b.parentElement)||void 0===n?void 0:n.className.includes(m))&&void 0!==e&&e},[b]);((e,n)=>{const{level:r,informParentOfChildNodes:o}=t.useContext(C);t.useEffect(()=>{r>0&&n()&&o(e)},[n,o,r,e])})(null!==(r=null==a?void 0:a.length)&&void 0!==r?r:0,L);const T=t.useCallback((e,n,t)=>{if(e&&e instanceof Element){const r=e=>{if(e){const n=Array.from(e.querySelectorAll("li.widget-tree-node-branch")),t=Array.from(e.querySelectorAll(".widget-tree-node-body[aria-hidden=true]"));return n.filter(e=>!t.some(n=>n.contains(e)))}return[]},o=Array.from(document.body.querySelectorAll(".widget-tree-node[role=tree]")).find(n=>n.contains(e));if(!o)return;const a=r(o),i=a.length;if(0===i)return;const d=a.findIndex(n=>n.isSameNode(e));switch(n){case"FIRST":a[0].focus();break;case"LAST":a[i-1].focus();break;case"PREVIOUS":{if("VERTICAL"===t){const n=r(document).filter(n=>{var t;return null===(t=n.lastElementChild)||void 0===t?void 0:t.contains(e)});return void(n.length>0&&n[n.length-1].focus())}const n=d-1,o=Math.max(n,0);o!==d&&a[o].focus();break}case"NEXT":{if("VERTICAL"===t){const n=r(e.lastElementChild);return void(n.length>0&&n[0].focus())}const n=d+1,o=Math.min(n,i-1);o!==d&&a[o].focus();break}}}},[]);return null===a||0===a.length?null:n.jsx("ul",{className:l("widget-tree-node",o),style:i,ref:x,"data-focusindex":N||0,role:0===A?"tree":"group",children:a.map(e=>{let{id:t,headerContent:r,bodyContent:o}=e;return n.jsx(p,{id:t,headerContent:r,isUserDefinedLeafNode:d,startExpanded:s,iconPlacement:u,renderHeaderIcon:S,changeFocus:T,animateTreeNodeContent:I,openNodeOn:w,children:o},t)})})}e.TreeNode=function(e){var r,o;const{datasource:a}=e,[i,d]=t.useState([]);t.useEffect(()=>{"available"===a.status&&(a.items&&a.items.length?d(a.items.map(n=>function(e,n){var t,r,o;return{id:e.id,headerContent:"text"===n.headerType?null===(t=n.headerCaption)||void 0===t?void 0:t.get(e).value:null===(r=n.headerContent)||void 0===r?void 0:r.get(e),bodyContent:null===(o=n.children)||void 0===o?void 0:o.get(e)}}(n,e))):d([]))},[a.status,a.items]);const c="available"===(null===(r=e.expandedIcon)||void 0===r?void 0:r.status)?e.expandedIcon.value:void 0,l="available"===(null===(o=e.collapsedIcon)||void 0===o?void 0:o.status)?e.collapsedIcon.value:void 0;return n.jsx(N,{class:e.class,style:e.style,items:i,isUserDefinedLeafNode:!e.hasChildren,startExpanded:e.startExpanded,showCustomIcon:Boolean(e.expandedIcon)||Boolean(e.collapsedIcon),iconPlacement:e.showIcon,expandedIcon:c,collapsedIcon:l,tabIndex:e.tabIndex,animateIcon:e.animate&&e.animateIcon,animateTreeNodeContent:e.animate,openNodeOn:e.openNodeOn})}});
