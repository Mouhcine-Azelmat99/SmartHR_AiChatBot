import{compareAttrValuesAsc as e,ChartWidget as t}from"../../../shared/charts/esm/shared-charts.mjs";import{useState as r,useEffect as o,useMemo as n,createElement as i}from"react";import a from"big.js";function l(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var u,s={exports:{}};
/*!
	Copyright (c) 2018 Jed Watson.
	Licensed under the MIT License (MIT), see
	http://jedwatson.github.io/classnames
*/var c,p,v=(u||(u=1,c=s,function(){var e={}.hasOwnProperty;function t(){for(var r=[],o=0;o<arguments.length;o++){var n=arguments[o];if(n){var i=typeof n;if("string"===i||"number"===i)r.push(n);else if(Array.isArray(n)){if(n.length){var a=t.apply(null,n);a&&r.push(a)}}else if("object"===i){if(n.toString!==Object.prototype.toString&&!n.toString.toString().includes("[native code]")){r.push(n.toString());continue}for(var l in n)e.call(n,l)&&n[l]&&r.push(l)}}}return r.join(" ")}c.exports?(t.default=t,c.exports=t):window.classNames=t}()),s.exports),d=l(v),f={},h={};var b,g={};var y,m={};var x,O,S={},A={};function _(){return O||(O=1,e=S,t=S&&S.__createBinding||(Object.create?function(e,t,r,o){void 0===o&&(o=r);var n=Object.getOwnPropertyDescriptor(t,r);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,o,n)}:function(e,t,r,o){void 0===o&&(o=r),e[o]=t[r]}),r=S&&S.__exportStar||function(e,r){for(var o in e)"default"===o||Object.prototype.hasOwnProperty.call(r,o)||t(r,e,o)},Object.defineProperty(e,"__esModule",{value:!0}),r((x||(x=1,Object.defineProperty(A,"__esModule",{value:!0})),A),e)),S;var e,t,r}var j,w,P,z={},C={};function V(){return w||(w=1,e=z,t=z&&z.__createBinding||(Object.create?function(e,t,r,o){void 0===o&&(o=r);var n=Object.getOwnPropertyDescriptor(t,r);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,o,n)}:function(e,t,r,o){void 0===o&&(o=r),e[o]=t[r]}),r=z&&z.__exportStar||function(e,r){for(var o in e)"default"===o||Object.prototype.hasOwnProperty.call(r,o)||t(r,e,o)},Object.defineProperty(e,"__esModule",{value:!0}),r(function(){if(j)return C;function e(e,r,o,n,i){t(((e,t,r)=>r.splice(t,1)),e,o,n,i)}function t(e,r,o,n,i){r.forEach((r=>{var a;r.propertyGroups&&t(e,r.propertyGroups,o,n,i),null===(a=r.properties)||void 0===a||a.forEach(((r,a,l)=>{r.key===o&&(void 0===n||void 0===i?e(r,a,l):r.objects?t(e,r.objects[n].properties,i):r.properties&&t(e,r.properties[n],i))}))}))}return j=1,Object.defineProperty(C,"__esModule",{value:!0}),C.hidePropertyIn=e,C.hidePropertiesIn=function(e,r,o){o.forEach((r=>t(((e,t,r)=>r.splice(t,1)),e,r,void 0,void 0)))},C.hideNestedPropertiesIn=function(t,r,o,n,i){i.forEach((i=>e(t,r,o,n,i)))},C.changePropertyIn=function(e,r,o,n,i,a){t(o,e,n,i,a)},C.transformGroupsIntoTabs=function(e){const t=[];e.forEach((e=>{e.propertyGroups&&(t.push(...e.propertyGroups),e.propertyGroups=[])})),e.push(...t)},C.moveProperty=function(e,t,r){e>=0&&t>=0&&e<r.length&&t<r.length&&e!==t&&r.splice(t,0,...r.splice(e,1))},C}(),e)),z;var e,t,r}var M,L,k,D=(P||(P=1,M=f,L=f&&f.__createBinding||(Object.create?function(e,t,r,o){void 0===o&&(o=r);var n=Object.getOwnPropertyDescriptor(t,r);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,o,n)}:function(e,t,r,o){void 0===o&&(o=r),e[o]=t[r]}),k=f&&f.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||L(t,e,r)},Object.defineProperty(M,"__esModule",{value:!0}),k((p||(p=1,Object.defineProperty(h,"__esModule",{value:!0}),h.ensure=function(e){if(null==e)throw new Error("Did not expect an argument to be undefined");return e}),h),M),k((b||(b=1,Object.defineProperty(g,"__esModule",{value:!0}),g.mergeNativeStyles=function(e,t){const r=[e,...t.filter((e=>void 0!==e))];return Object.keys(e).reduce(((e,t)=>{const o=r.map((e=>e[t]));return Object.assign(Object.assign({},e),{[t]:(n=o,n.reduce(((e,t)=>Object.assign(Object.assign({},e),t)),{}))});var n}),{})},g.extractStyles=function(e,t){return e?Object.entries(e).reduce(((e,r)=>{let[o,n]=e,[i,a]=r;return t.includes(i)?o[i]=a:n[i]=a,[o,n]}),[{},{}]):[{},{}]}),g),M),k((y||(y=1,Object.defineProperty(m,"__esModule",{value:!0}),m.parseInlineStyle=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";try{return e.split(";").reduce(((e,t)=>{const r=t.split(":");return 2===r.length&&(e[r[0].trim().replace(/(-.)/g,(e=>e[1].toUpperCase()))]=r[1].trim()),e}),{})}catch(e){return{}}}),m),M),k(_(),M),k(V(),M)),f);function E(e){return Array.from(new Set(e))}function T(e){return 0-e}function I(e){return e.length>1?e.sort(((e,t)=>e.valuePercentage-t.valuePercentage)).map((e=>[Math.abs(e.valuePercentage/100),e.colour])):[[0,"#17347B"],[.5,"#0595DB"],[1,"#76CA02"]]}function G(e){return e&&e instanceof a?e.toNumber():e}const N={font:{color:"#555",size:12},margin:{l:80,pad:0},legend:{font:{family:"Open Sans",size:14}},xaxis:{fixedrange:!0,ticks:""},yaxis:{fixedrange:!0,ticks:"",title:{standoff:5}}},B={responsive:!0},U={type:"heatmap",hoverinfo:"none",xgap:1,ygap:1,colorbar:{y:1,yanchor:"top",ypad:0,xpad:5,outlinecolor:"#9ba492"},connectgaps:!1};function H(a){var l,u;const s=(t=>{let{customSeriesOptions:i,horizontalAxisAttribute:a,horizontalSortAttribute:l,horizontalSortOrder:u,onClickAction:s,scaleColors:c,seriesDataSource:p,seriesValueAttribute:v,showScale:d,smoothColor:f,tooltipHoverText:h,verticalAxisAttribute:b,verticalSortAttribute:g,verticalSortOrder:y}=t;const[m,x]=r([]);o((()=>{if("available"===p.status&&p.items){const e=p.items.map((e=>{var t;return{value:null===(t=D.ensure(v).get(e).value)||void 0===t?void 0:t.toNumber(),hoverText:null==h?void 0:h.get(e).value,horizontalAxisValue:G(null==a?void 0:a.get(e).value),horizontalSortValue:null==l?void 0:l.get(e).value,verticalAxisValue:G(null==b?void 0:b.get(e).value),verticalSortValue:null==g?void 0:g.get(e).value}}));x(e)}}),[p,v,h,a,b,l,g]);const O=n((()=>s?()=>{var e;(e=s)&&e.canExecute&&!e.isExecuting&&e.execute()}:void 0),[s]);return n((()=>{const t=[...m];g&&t.sort(((t,r)=>{const o=e(t.verticalSortValue,r.verticalSortValue);return"desc"===y?T(o):o}));const r=E(t.map((e=>{let{verticalAxisValue:t}=e;return t})));l&&t.sort(((t,r)=>{const o=e(t.horizontalSortValue,r.horizontalSortValue);return"desc"===u?T(o):o}));const o=E(t.map((e=>{let{horizontalAxisValue:t}=e;return t}))),n=r.map((e=>o.map((r=>t.find((t=>{let{horizontalAxisValue:o,verticalAxisValue:n}=t;return o===r&&n===e})))))),a=n.map((e=>e.map((e=>{var t;return null!==(t=null==e?void 0:e.value)&&void 0!==t?t:null})))),s=n.map((e=>e.map((e=>{var t;return null!==(t=null==e?void 0:e.hoverText)&&void 0!==t?t:""}))));return[{colorscale:I(c),customSeriesOptions:i,hoverinfo:h?"text":"none",hovertext:s,onClick:O,showscale:d,x:o.map((e=>{var t;return null!==(t=null==e?void 0:e.toLocaleString())&&void 0!==t?t:null})),y:r.map((e=>{var t;return null!==(t=null==e?void 0:e.toLocaleString())&&void 0!==t?t:null})),z:a,zsmooth:!!f&&"best",dataSourceItems:[]}]}),[i,m,l,u,O,c,d,f,h,g,y])})({customSeriesOptions:a.customSeriesOptions,horizontalAxisAttribute:a.horizontalAxisAttribute,horizontalSortAttribute:a.horizontalSortAttribute,horizontalSortOrder:a.horizontalSortOrder,onClickAction:a.onClickAction,scaleColors:a.scaleColors,seriesDataSource:a.seriesDataSource,seriesValueAttribute:a.seriesValueAttribute,showScale:a.showScale,smoothColor:a.smoothColor,tooltipHoverText:a.tooltipHoverText,verticalAxisAttribute:a.verticalAxisAttribute,verticalSortAttribute:a.verticalSortAttribute,verticalSortOrder:a.verticalSortOrder}),c=n((()=>{const e=a.showValues?s[0].z.reduce(((e,t,r)=>[...e,...t.map(((e,t)=>{var o,n,i,l,u,c,p;return l=null!==(o=s[0].x[t])&&void 0!==o?o:void 0,u=null!==(n=s[0].y[r])&&void 0!==n?n:void 0,c=null!==(i=null==e?void 0:e.toLocaleString())&&void 0!==i?i:"",p=a.valuesColor,{xref:"x",yref:"y",x:l,y:u,text:c,font:{family:"Open Sans",size:14,color:p||"#555"},showarrow:!1}}))]),[]):[];return{...N,annotations:e}}),[s,a.showValues,a.valuesColor]);return i(t,{type:"HeatMap",className:d("widget-heatmap-chart",a.class),data:s,width:a.width,widthUnit:a.widthUnit,height:a.height,heightUnit:a.heightUnit,showLegend:a.showScale,xAxisLabel:null===(l=a.xAxisLabel)||void 0===l?void 0:l.value,yAxisLabel:null===(u=a.yAxisLabel)||void 0===u?void 0:u.value,gridLinesMode:a.gridLines,customLayout:a.customLayout,customConfig:a.customConfigurations,layoutOptions:c,configOptions:B,seriesOptions:U,enableThemeConfig:a.enableThemeConfig,playground:a.playground})}export{H as HeatMap};
